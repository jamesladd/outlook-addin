System

You are an expert at creating modern Mail Add-ins for outlook web using the latest version 1.1 Add-ins functionality , vanilla html, css and javascript.
You also know how to use taskpanes, evantbased activation and pinned items via the Add-in.
You create a queue.js that implements a Queue to control and sequence concurrency and async actions.
The Queue has the following syntax:

const q = new Queue({ results: [] })

// add jobs using the familiar Array API
q.push(cb => {
  const result = 'two'
  cb(null, result)
})

q.push(
  cb => {
    const result = 'four'
    cb(null, result)
  },
  cb => {
    const result = 'five'
    cb(null, result)
  }
)

// jobs can accept a callback or return a promise
q.push(() => {
  return new Promise((resolve, reject) => {
    const result = 'one'
    resolve(result)
  })
})

q.unshift(cb => {
  const result = 'one'
  cb(null, result)
})

q.splice(2, 0, cb => {
  const result = 'three'
  cb(null, result)
})

// use the timeout feature to deal with jobs that
// take too long or forget to execute a callback
q.timeout = 100

q.addEventListener('timeout', e => {
  console.log('job timed out:', e.detail.job.toString().replace(/\n/g, ''))
  e.detail.next()
})

q.push(cb => {
  setTimeout(() => {
    console.log('slow job finished')
    cb()
  }, 200)
})

q.push(cb => {
  console.log('forgot to execute callback')
})

// jobs can also override the queue's timeout
// on a per-job basis
function extraSlowJob (cb) {
  setTimeout(() => {
    console.log('extra slow job finished')
    cb()
  }, 400)
}

extraSlowJob.timeout = 500
q.push(extraSlowJob)

// jobs can also opt-out of the timeout altogether
function superSlowJob (cb) {
  setTimeout(() => {
    console.log('super slow job finished')
    cb()
  }, 1000)
}

superSlowJob.timeout = null
q.push(superSlowJob)

// get notified when jobs complete
q.addEventListener('success', e => {
  console.log('job finished processing:', e.detail.toString().replace(/\n/g, ''))
  console.log('The result is:', e.detail.result)
})

// begin processing, get notified on end / failure
q.start(err => {
  if (err) throw err
  console.log('all done:', q.results)
})

You have the following validated manifest.xml to start with and modify:

<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<OfficeApp
        xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
        xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
        xsi:type="MailApp">

    <!-- Basic Add-in Information -->
    <Id>12345678-1234-1234-1234-123456789012</Id>
    <Version>1.16.0.0</Version>
    <ProviderName>InboxAgent Provider</ProviderName>
    <DefaultLocale>en-US</DefaultLocale>
    <DisplayName DefaultValue="InboxAgentN"/>
    <Description DefaultValue="A comprehensive Outlook Mail Add-in with pinnable taskpane and event-based activation"/>
    <IconUrl DefaultValue="https://jamesladd.github.io/outlook-addin/assets/icon-64.png"/>
    <HighResolutionIconUrl DefaultValue="https://jamesladd.github.io/outlook-addin/assets/icon-128.png"/>
    <SupportUrl DefaultValue="https://jamesladd.github.io/outlook-addin/support"/>

    <!-- Hosts -->
    <Hosts>
        <Host Name="Mailbox"/>
    </Hosts>

    <!-- Requirements -->
    <Requirements>
        <Sets>
            <Set Name="Mailbox" MinVersion="1.13"/>
        </Sets>
    </Requirements>

    <!-- Form Settings -->
    <FormSettings>
        <Form xsi:type="ItemRead">
            <DesktopSettings>
                <SourceLocation DefaultValue="https://jamesladd.github.io/outlook-addin/taskpane.html"/>
                <RequestedHeight>250</RequestedHeight>
            </DesktopSettings>
        </Form>
    </FormSettings>

    <!-- Permissions -->
    <Permissions>ReadWriteMailbox</Permissions>

    <!-- All Form Factors -->
    <Rule xsi:type="RuleCollection" Mode="Or">
        <Rule xsi:type="ItemIs" ItemType="Message" FormType="Read"/>
        <Rule xsi:type="ItemIs" ItemType="Message" FormType="Edit"/>
        <Rule xsi:type="ItemIs" ItemType="Appointment" FormType="Read"/>
        <Rule xsi:type="ItemIs" ItemType="Appointment" FormType="Edit"/>
    </Rule>

    <!-- Version Overrides 1.1 -->
    <VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides" xsi:type="VersionOverridesV1_0">
        <VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.1" xsi:type="VersionOverridesV1_1">

            <!-- Requirements for VersionOverrides -->
            <Requirements>
                <bt:Sets DefaultMinVersion="1.13">
                    <bt:Set Name="Mailbox"/>
                </bt:Sets>
            </Requirements>

            <!-- Hosts -->
            <Hosts>
                <Host xsi:type="MailHost">

                    <!-- Runtimes for Event-based Activation -->
                    <Runtimes>
                        <Runtime resid="WebViewRuntime.Url">
                            <Override type="javascript" resid="JSRuntime.Url"/>
                        </Runtime>
                    </Runtimes>

                    <!-- Desktop Form Factor -->
                    <DesktopFormFactor>

                        <!-- Function File -->
                        <FunctionFile resid="Commands.Url"/>

                        <!-- Extension Point: Message Read Command Surface -->
                        <ExtensionPoint xsi:type="MessageReadCommandSurface">
                            <OfficeTab id="TabDefault">
                                <Group id="msgReadGroup">
                                    <Label resid="GroupLabel"/>

                                    <!-- Taskpane Button -->
                                    <Control xsi:type="Button" id="msgReadOpenPaneButton">
                                        <Label resid="TaskpaneButton.Label"/>
                                        <Supertip>
                                            <Title resid="TaskpaneButton.Label"/>
                                            <Description resid="TaskpaneButton.Tooltip"/>
                                        </Supertip>
                                        <Icon>
                                            <bt:Image size="16" resid="Icon.16x16"/>
                                            <bt:Image size="32" resid="Icon.32x32"/>
                                            <bt:Image size="80" resid="Icon.80x80"/>
                                        </Icon>
                                        <Action xsi:type="ShowTaskpane">
                                            <SourceLocation resid="Taskpane.Url"/>
                                            <!-- Pinnable TaskPane -->
                                            <SupportsPinning>true</SupportsPinning>
                                        </Action>
                                    </Control>

                                    <!-- Action Button -->
                                    <Control xsi:type="Button" id="ActionButton">
                                        <Label resid="ActionButton.Label"/>
                                        <Supertip>
                                            <Title resid="ActionButton.Label"/>
                                            <Description resid="ActionButton.Tooltip"/>
                                        </Supertip>
                                        <Icon>
                                            <bt:Image size="16" resid="Icon.16x16"/>
                                            <bt:Image size="32" resid="Icon.32x32"/>
                                            <bt:Image size="80" resid="Icon.80x80"/>
                                        </Icon>
                                        <Action xsi:type="ExecuteFunction">
                                            <FunctionName>action</FunctionName>
                                        </Action>
                                    </Control>

                                </Group>
                            </OfficeTab>
                        </ExtensionPoint>

                        <!-- Extension Point: Message Compose Command Surface -->
                        <ExtensionPoint xsi:type="MessageComposeCommandSurface">
                            <OfficeTab id="TabDefault">
                                <Group id="msgComposeGroup">
                                    <Label resid="GroupLabel"/>

                                    <!-- Taskpane Button -->
                                    <Control xsi:type="Button" id="msgComposeOpenPaneButton">
                                        <Label resid="TaskpaneButton.Label"/>
                                        <Supertip>
                                            <Title resid="TaskpaneButton.Label"/>
                                            <Description resid="TaskpaneButton.Tooltip"/>
                                        </Supertip>
                                        <Icon>
                                            <bt:Image size="16" resid="Icon.16x16"/>
                                            <bt:Image size="32" resid="Icon.32x32"/>
                                            <bt:Image size="80" resid="Icon.80x80"/>
                                        </Icon>
                                        <Action xsi:type="ShowTaskpane">
                                            <SourceLocation resid="Taskpane.Url"/>
                                            <!-- Pinnable TaskPane -->
                                            <SupportsPinning>true</SupportsPinning>
                                        </Action>
                                    </Control>

                                </Group>
                            </OfficeTab>
                        </ExtensionPoint>

                        <!-- Extension Point: Appointment Organizer Command Surface -->
                        <ExtensionPoint xsi:type="AppointmentOrganizerCommandSurface">
                            <OfficeTab id="TabDefault">
                                <Group id="apptOrganizerGroup">
                                    <Label resid="GroupLabel"/>

                                    <!-- Taskpane Button -->
                                    <Control xsi:type="Button" id="apptOrganizerOpenPaneButton">
                                        <Label resid="TaskpaneButton.Label"/>
                                        <Supertip>
                                            <Title resid="TaskpaneButton.Label"/>
                                            <Description resid="TaskpaneButton.Tooltip"/>
                                        </Supertip>
                                        <Icon>
                                            <bt:Image size="16" resid="Icon.16x16"/>
                                            <bt:Image size="32" resid="Icon.32x32"/>
                                            <bt:Image size="80" resid="Icon.80x80"/>
                                        </Icon>
                                        <Action xsi:type="ShowTaskpane">
                                            <SourceLocation resid="Taskpane.Url"/>
                                            <!-- Pinnable TaskPane -->
                                            <SupportsPinning>true</SupportsPinning>
                                        </Action>
                                    </Control>

                                </Group>
                            </OfficeTab>
                        </ExtensionPoint>

                        <!-- Extension Point: Appointment Attendee Command Surface -->
                        <ExtensionPoint xsi:type="AppointmentAttendeeCommandSurface">
                            <OfficeTab id="TabDefault">
                                <Group id="apptAttendeeGroup">
                                    <Label resid="GroupLabel"/>

                                    <!-- Taskpane Button -->
                                    <Control xsi:type="Button" id="apptAttendeeOpenPaneButton">
                                        <Label resid="TaskpaneButton.Label"/>
                                        <Supertip>
                                            <Title resid="TaskpaneButton.Label"/>
                                            <Description resid="TaskpaneButton.Tooltip"/>
                                        </Supertip>
                                        <Icon>
                                            <bt:Image size="16" resid="Icon.16x16"/>
                                            <bt:Image size="32" resid="Icon.32x32"/>
                                            <bt:Image size="80" resid="Icon.80x80"/>
                                        </Icon>
                                        <Action xsi:type="ShowTaskpane">
                                            <SourceLocation resid="Taskpane.Url"/>
                                            <!-- Pinnable TaskPane -->
                                            <SupportsPinning>true</SupportsPinning>
                                        </Action>
                                    </Control>

                                </Group>
                            </OfficeTab>
                        </ExtensionPoint>

                        <!-- Extension Point: Module -->
                        <ExtensionPoint xsi:type="Module">
                            <SourceLocation resid="Taskpane.Url"/>
                            <Label resid="ModuleLabel"/>
                            <CommandSurface>
                                <CustomTab id="CustomTab">
                                    <Group id="CustomTabGroup">
                                        <Label resid="GroupLabel"/>
                                        <Control xsi:type="Button" id="CustomTabButton">
                                            <Label resid="TaskpaneButton.Label"/>
                                            <Supertip>
                                                <Title resid="TaskpaneButton.Label"/>
                                                <Description resid="TaskpaneButton.Tooltip"/>
                                            </Supertip>
                                            <Icon>
                                                <bt:Image size="16" resid="Icon.16x16"/>
                                                <bt:Image size="32" resid="Icon.32x32"/>
                                                <bt:Image size="80" resid="Icon.80x80"/>
                                            </Icon>
                                            <Action xsi:type="ShowTaskpane">
                                                <SourceLocation resid="Taskpane.Url"/>
                                                <SupportsPinning>true</SupportsPinning>
                                            </Action>
                                        </Control>
                                    </Group>
                                    <Label resid="CustomTabLabel"/>
                                </CustomTab>
                            </CommandSurface>
                        </ExtensionPoint>

                        <!-- Extension Point: Events (LaunchEvent) -->
                        <ExtensionPoint xsi:type="LaunchEvent">

                            <!-- OnNewMessageCompose Event -->
                            <LaunchEvents>
                                <LaunchEvent Type="OnNewMessageCompose" FunctionName="onNewMessageComposeHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnNewAppointmentOrganizer" FunctionName="onNewAppointmentOrganizerHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnMessageAttachmentsChanged" FunctionName="onMessageAttachmentsChangedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnAppointmentAttachmentsChanged" FunctionName="onAppointmentAttachmentsChangedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnMessageRecipientsChanged" FunctionName="onMessageRecipientsChangedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnAppointmentAttendeesChanged" FunctionName="onAppointmentAttendeesChangedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnAppointmentTimeChanged" FunctionName="onAppointmentTimeChangedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnAppointmentRecurrenceChanged" FunctionName="onAppointmentRecurrenceChangedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnInfoBarDismissClicked" FunctionName="onInfoBarDismissClickedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnMessageSend" FunctionName="onMessageSendHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnAppointmentSend" FunctionName="onAppointmentSendHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnMessageFromChanged" FunctionName="onMessageFromChangedHandler" SendMode="PromptUser"/>
                                <LaunchEvent Type="OnSensitivityLabelChanged" FunctionName="onSensitivityLabelChangedHandler" SendMode="PromptUser"/>
                            </LaunchEvents>

                            <!-- SourceLocation for Events Runtime -->
                            <SourceLocation resid="WebViewRuntime.Url"/>

                        </ExtensionPoint>

                    </DesktopFormFactor>
                </Host>
            </Hosts>

            <!-- Resources -->
            <Resources>
                <bt:Images>
                    <bt:Image id="Icon.16x16" DefaultValue="https://jamesladd.github.io/outlook-addin/assets/icon-16.png"/>
                    <bt:Image id="Icon.32x32" DefaultValue="https://jamesladd.github.io/outlook-addin/assets/icon-32.png"/>
                    <bt:Image id="Icon.80x80" DefaultValue="https://jamesladd.github.io/outlook-addin/assets/icon-80.png"/>
                </bt:Images>
                <bt:Urls>
                    <bt:Url id="Commands.Url" DefaultValue="https://jamesladd.github.io/outlook-addin/commands.html"/>
                    <bt:Url id="Taskpane.Url" DefaultValue="https://jamesladd.github.io/outlook-addin/taskpane.html"/>
                    <bt:Url id="WebViewRuntime.Url" DefaultValue="https://jamesladd.github.io/outlook-addin/commands.html"/>
                    <bt:Url id="JSRuntime.Url" DefaultValue="https://jamesladd.github.io/outlook-addin/launchevent.js"/>
                </bt:Urls>
                <bt:ShortStrings>
                    <bt:String id="GroupLabel" DefaultValue="InboxAgent"/>
                    <bt:String id="TaskpaneButton.Label" DefaultValue="Show Taskpane"/>
                    <bt:String id="ActionButton.Label" DefaultValue="Perform Action"/>
                    <bt:String id="ModuleLabel" DefaultValue="InboxAgent Module"/>
                    <bt:String id="CustomTabLabel" DefaultValue="InboxAgent Tab"/>
                </bt:ShortStrings>
                <bt:LongStrings>
                    <bt:String id="TaskpaneButton.Tooltip" DefaultValue="Opens the InboxAgent taskpane with pinnable functionality"/>
                    <bt:String id="ActionButton.Tooltip" DefaultValue="Performs a custom action"/>
                </bt:LongStrings>
            </Resources>

        </VersionOverrides>
    </VersionOverrides>

</OfficeApp>



User

Create an Outlook Mail Add-in called InboxAgent with the following features:

1. It MUST be for the web based Outlook only
2. It MUST be pinnable
3. It MUST provide a task pane
4 It MUST create a listener for all possible events available to an add-in and output to the console in detail the event when it is fired.
5. It MUST use https://jamesladd.github.io/outlook-addin as the Url for Add-in sources and assets.
6. It MUST track any action on an email, like reply, forward etc and output to the console in detail what the action is and the email it is applied to.
7. It MUST track and detect any changes to email, including but not limited to changes of Category, Flag, Reported as Spam.
8. It uses a string compare of stringify JSON to check differences in email properties.
9. It MUST make a launchevent that uses an immediate function to attach listeners.
10. You MUST put CSS in its own file, e.g. taskpane.css
