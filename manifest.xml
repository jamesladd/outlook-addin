<!-- Version Overrides for modern UI -->
<VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides" xsi:type="VersionOverridesV1_0">

    <Requirements>
        <bt:Sets DefaultMinVersion="1.5" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0">
            <bt:Set Name="Mailbox"/>
        </bt:Sets>
    </Requirements>

    <Hosts>
        <Host xsi:type="MailHost">

            <!-- Desktop Form Factor -->
            <DesktopFormFactor>

                <!-- Function file for commands -->
                <FunctionFile resid="Commands.Url"/>

                <!-- Extension point for message read mode (when viewing an email) -->
                <ExtensionPoint xsi:type="MessageReadCommandSurface">
                    <OfficeTab id="TabDefault">
                        <Group id="msgReadGroup" SupportsPinning="true">
                            <Label resid="GroupLabel"/>

                            <!-- Button to open Task Pane -->
                            <Control xsi:type="Button" id="msgReadOpenPaneButton">
                                <Label resid="TaskPaneButton.Label"/>
                                <Supertip>
                                    <Title resid="TaskPaneButton.Label"/>
                                    <Description resid="TaskPaneButton.Tooltip"/>
                                </Supertip>
                                <Icon>
                                    <bt:Image size="16" resid="Icon.16x16" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="32" resid="Icon.32x32" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="80" resid="Icon.80x80" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                </Icon>
                                <Action xsi:type="ShowTaskpane">
                                    <SourceLocation resid="Taskpane.Url"/>
                                </Action>
                            </Control>

                            <!-- InboxAgent Button (shows alert) -->
                            <Control xsi:type="Button" id="msgReadAlertButton">
                                <Label resid="AlertButton.Label"/>
                                <Supertip>
                                    <Title resid="AlertButton.Label"/>
                                    <Description resid="AlertButton.Tooltip"/>
                                </Supertip>
                                <Icon>
                                    <bt:Image size="16" resid="Icon.16x16" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="32" resid="Icon.32x32" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="80" resid="Icon.80x80" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                </Icon>
                                <Action xsi:type="ExecuteFunction">
                                    <FunctionName>showAlert</FunctionName>
                                </Action>
                            </Control>

                        </Group>
                    </OfficeTab>
                </ExtensionPoint>

                <!-- Extension point for message compose mode -->
                <ExtensionPoint xsi:type="MessageComposeCommandSurface">
                    <OfficeTab id="TabDefault">
                        <Group id="msgComposeGroup" SupportsPinning="true">
                            <Label resid="GroupLabel"/>

                            <!-- Button to open Task Pane -->
                            <Control xsi:type="Button" id="msgComposeOpenPaneButton">
                                <Label resid="TaskPaneButton.Label"/>
                                <Supertip>
                                    <Title resid="TaskPaneButton.Label"/>
                                    <Description resid="TaskPaneButton.Tooltip"/>
                                </Supertip>
                                <Icon>
                                    <bt:Image size="16" resid="Icon.16x16" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="32" resid="Icon.32x32" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="80" resid="Icon.80x80" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                </Icon>
                                <Action xsi:type="ShowTaskpane">
                                    <SourceLocation resid="Taskpane.Url"/>
                                </Action>
                            </Control>

                            <!-- InboxAgent Button (shows alert) -->
                            <Control xsi:type="Button" id="msgComposeAlertButton">
                                <Label resid="AlertButton.Label"/>
                                <Supertip>
                                    <Title resid="AlertButton.Label"/>
                                    <Description resid="AlertButton.Tooltip"/>
                                </Supertip>
                                <Icon>
                                    <bt:Image size="16" resid="Icon.16x16" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="32" resid="Icon.32x32" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                    <bt:Image size="80" resid="Icon.80x80" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"/>
                                </Icon>
                                <Action xsi:type="ExecuteFunction">
                                    <FunctionName>showAlert</FunctionName>
                                </Action>
                            </Control>

                        </Group>
                    </OfficeTab>
                </ExtensionPoint>

            </DesktopFormFactor>
        </Host>
    </Hosts>

    <!-- Resources section remains the same -->
    <Resources>
        <bt:Images xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0">
            <bt:Image id="Icon.16x16" DefaultValue="https://jamesladd.github.io/outlook-addin/assets/favicon-144x144.png"/>
            <bt:Image id="Icon.32x32" DefaultValue="https://jamesladd.github.io/outlook-addin/assets/favicon-144x144.png"/>
            <bt:Image id="Icon.80x80" DefaultValue="https://jamesladd.github.io/outlook-addin/assets/favicon-144x144.png"/>
        </bt:Images>
        <bt:Urls xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0">
            <bt:Url id="Commands.Url" DefaultValue="https://jamesladd.github.io/outlook-addin/commands.html"/>
            <bt:Url id="Taskpane.Url" DefaultValue="https://jamesladd.github.io/outlook-addin/taskpane.html"/>
        </bt:Urls>
        <bt:ShortStrings xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0">
            <bt:String id="GroupLabel" DefaultValue="InboxAgent"/>
            <bt:String id="TaskPaneButton.Label" DefaultValue="My Task"/>
            <bt:String id="AlertButton.Label" DefaultValue="InboxAgent"/>
        </bt:ShortStrings>
        <bt:LongStrings xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0">
            <bt:String id="TaskPaneButton.Tooltip" DefaultValue="Opens the task pane to view user information and reports"/>
            <bt:String id="AlertButton.Tooltip" DefaultValue="Click to show alert"/>
        </bt:LongStrings>
    </Resources>
</VersionOverrides>